/** libs/core/persistence/prisma/schema.prisma */

generator client {
  provider = "prisma-client-js"
  // Prisma 7 optimiza automáticamente la ubicación en node_modules
}

datasource db {
  provider = "postgresql"
  /** 
   * @note Soberanía de Configuración Prisma 7
   * La propiedad 'url' ha sido movida a 'prisma.config.ts' para permitir
   * inyección dinámica y soporte WASM/Edge.
   */
}

model Tenant {
  id               String   @id @default(uuid())
  organizationName String
  urlSlug          String   @unique
  status           String   @default("ACTIVE")
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@map("tenants")
}

model SupportThread {
  id             String   @id @default(uuid())
  externalUserId String
  tenantId       String
  content        String   @db.Text
  channel        String
  metadata       Json     @default("{}")
  createdAt      DateTime @default(now())

  @@index([tenantId, externalUserId])
  @@map("support_threads")
}